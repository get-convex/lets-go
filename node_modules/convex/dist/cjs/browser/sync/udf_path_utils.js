"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.serializePathAndArgs = exports.canonicalizeUdfPath = void 0;
const common_1 = require("@convex-dev/common");
function canonicalizeUdfPath(udfPath) {
    const pieces = udfPath.split(":");
    let moduleName;
    let functionName;
    if (pieces.length == 1) {
        moduleName = pieces[0];
        functionName = "default";
    }
    else {
        moduleName = pieces.slice(0, pieces.length - 1).join(":");
        functionName = pieces[pieces.length - 1];
    }
    if (!moduleName.endsWith(".js")) {
        moduleName = `${moduleName}.js`;
    }
    return `${moduleName}:${functionName}`;
}
exports.canonicalizeUdfPath = canonicalizeUdfPath;
// TODO(CX-749): Make this a unique representation (sort sets, dicts, objects)
function serializePathAndArgs(udfPath, args) {
    return JSON.stringify({
        udfPath: canonicalizeUdfPath(udfPath),
        args: (0, common_1.convexToJson)(args),
    });
}
exports.serializePathAndArgs = serializePathAndArgs;
//# sourceMappingURL=udf_path_utils.js.map